<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo - Fullhouse Vintage</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="shortcut icon" href="IMGs/logo-white.ico" />
    <script src="script.js" defer></script>
</head>
<body>
    <header>
        <div class="logo-container">
            <div class="logo">
                <img src="IMGs/logo-white.png" alt="Fullhouse Vintage Logo">
            </div>
            <div class="logo-text">
                <h3>FULL HOUSE VINTAGE</h3>
            </div>
        </div>

        <nav>
            <ul class="menu">
                <li><a href="index.html">INICIO</a></li>
                <li><a href="catalogo.html">CAT√ÅLOGO</a></li>
                <li><a href="nosotros.html">NOSOTROS</a></li>
                <li><a href="contact.html">CONTACTO</a></li>
            </ul>
        </nav>

        <div class="header-icons">
            <form class="search-container" id="searchForm">
                <input type="text" class="search-input" id="searchInput" placeholder="Buscar productos...">
                <button type="submit" class="search-icon">
                    <img src="IMGs/search.png" alt="Buscar" class="header-icon">
                </button>
            </form>
            <a href="favoritos.html" class="icon-link">
                <img src="IMGs/favourite.png" alt="Favoritos" class="header-icon">
            </a>
            <div class="icon-cart" id="cartIcon">
                <img src="IMGs/shopping-cart.png" alt="Carrito" class="header-icon">
                <span>0</span>
            </div>
            <a href="perfil.html" class="icon-link">
                <img src="IMGs/user.png" alt="Perfil" class="header-icon">
            </a>
        </div>
    </header>

    <div class="cartTab">
        <h1>Carrito de Compras</h1>
        <div class="listCart">
            <!-- Items del carrito ir√°n aqu√≠ -->
        </div>
        <div class="btn">
            <button class="close">Cerrar</button>
            <button class="checkOut" onclick="window.location.href='pago.html'">Pagar</button>
        </div>
    </div>

    <!-- Filtros y B√∫squeda -->
    <section class="catalog-filters">
        <div class="filter-container">
            <select class="filter-select" id="categoria">
                <option value="">Todas las Categor√≠as</option>
                <option value="ropa">Ropa</option>
                <option value="accesorios">Accesorios</option>
                <option value="calzado">Calzado</option>
            </select>
            <select class="filter-select" id="decada">
                <option value="">Todas las D√©cadas</option>
                <option value="60s">60s</option>
                <option value="70s">70s</option>
                <option value="80s">80s</option>
                <option value="90s">90s</option>
            </select>
            <select class="filter-select" id="precio">
                <option value="">Todos los Precios</option>
                <option value="0-50">0-50‚Ç¨</option>
                <option value="50-100">50-100‚Ç¨</option>
                <option value="100+">100‚Ç¨+</option>
            </select>
        </div>
    </section>

    <!-- Rejilla de productos -->
    <section class="products-grid" id="productsGrid">
        <!-- Los productos se cargar√°n aqu√≠ din√°micamente -->
    </section>

    <!-- Reemplazar la secci√≥n de paginaci√≥n -->
    <div class="pagination">
        <!-- Los botones se generar√°n din√°micamente con JavaScript -->
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Sobre Nosotros</h4>
                <p>Full House Vintage, tu destino para moda vintage aut√©ntica y sostenible desde 2010.</p>
                <div class="social-links">
                    <a href="#"><img src="IMGs/fb.png" alt="Facebook" class="social-icon"></a>
                    <a href="#"><img src="IMGs/inst.png" alt="Instagram" class="social-icon"></a>
                    <a href="#"><img src="IMGs/X.png" alt="Twitter" class="social-icon"></a>
                </div>
            </div>

            <div class="footer-section">
                <h4>Enlaces R√°pidos</h4>
                <ul class="footer-links">
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="catalogo.html">Cat√°logo</a></li>
                    <li><a href="nosotros.html">Nosotros</a></li>
                    <li><a href="contact.html">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Ayuda</h4>
                <ul class="footer-links">
                    <li><a href="nosotros.html">FAQ</a></li>
                    <li><a href="envios.html">Env√≠os</a></li>
                    <li><a href="devoluciones.html">Devoluciones</a></li>
                    <li><a href="privacidad.html">Pol√≠tica de Privacidad</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h4>Contacto</h4>
                <ul class="footer-links">
                    <li>üìç Calle Principal, 123</li>
                    <li>üìû +34 123 456 789</li>
                    <li>‚úâÔ∏è info@fullhousevintage.com</li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2024 Full House Vintage. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Comprobar si hay un par√°metro de b√∫squeda en la URL
            const urlParams = new URLSearchParams(window.location.search);
            const searchQuery = urlParams.get('search');
            
            // Cargar los productos
            await loadProducts();
            
            // Si hay una b√∫squeda, realizar la b√∫squeda y actualizar el input
            if (searchQuery) {
                const searchInput = document.getElementById('searchInput');
                searchInput.value = searchQuery;
                performSearch(searchQuery);
            }

            // Configurar el formulario de b√∫squeda
            const searchForm = document.getElementById('searchForm');
            const searchInput = document.getElementById('searchInput');
            
            // Manejar env√≠o del formulario
            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                performSearch(searchInput.value);
            });
            
            // B√∫squeda en tiempo real
            searchInput.addEventListener('input', () => {
                clearTimeout(window.searchTimeout);
                window.searchTimeout = setTimeout(() => {
                    performSearch(searchInput.value);
                }, 300);
            });
        });
        
        async function loadProducts() {
            try {
                const response = await fetch('data/products.json');
                const data = await response.json();
                window.products = data.products;
                displayProducts(data.products);
            } catch (error) {
                console.error('Error al cargar los productos:', error);
            }
        }
        
        function performSearch(query = null) {
            // Si no se proporciona query, tomarla del input
            if (query === null) {
                query = document.getElementById('searchInput').value;
            }
            
            query = query.toLowerCase().trim();
            if (!window.products) {
                console.error('Los productos no est√°n cargados todav√≠a');
                return;
            }
            
            const filteredProducts = !query ? window.products : window.products.filter(product => 
                product.name.toLowerCase().includes(query) ||
                (product.description && product.description.toLowerCase().includes(query)) ||
                (product.category && product.category.toLowerCase().includes(query)) ||
                (product.decade && product.decade.toLowerCase().includes(query))
            );
            
            displayProducts(filteredProducts);
            
            // Actualizar la URL sin recargar la p√°gina
            const newUrl = new URL(window.location);
            if (query) {
                newUrl.searchParams.set('search', query);
            } else {
                newUrl.searchParams.delete('search');
            }
            window.history.pushState({}, '', newUrl);
        }
        
        function displayProducts(products) {
            const productsGrid = document.getElementById('productsGrid');
            if (!productsGrid) return;
            
            productsGrid.innerHTML = '';
            
            if (products.length === 0) {
                productsGrid.innerHTML = `
                    <div class="no-results">
                        No se encontraron productos que coincidan con tu b√∫squeda
                    </div>`;
                return;
            }
        
            products.forEach(product => {
                const productHTML = `
                    <article class="product-card">
                        <div class="product-image">
                            <a href="producto.html?id=${product.id}">
                                <img src="${product.image}" alt="${product.name}">
                            </a>
                        </div>
                        <div class="product-info">
                            <div class="product-details">
                                <h3><a href="producto.html?id=${product.id}">${product.name}</a></h3>
                                <p class="product-description">${product.description || ''}</p>
                            </div>
                            <div class="product-bottom">
                                <p class="price">${product.price.toFixed(2)}‚Ç¨</p>
                                <button class="add-to-cart-btn" onclick="addToCart(${product.id})">
                                    A√±adir al Carrito
                                </button>
                            </div>
                        </div>
                    </article>
                `;
                productsGrid.innerHTML += productHTML;
            });
        }
    </script>
</body>
</html>
